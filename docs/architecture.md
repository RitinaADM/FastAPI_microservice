# Архитектура проекта

## Гексагональная архитектура

Этот сервис следует паттерну гексагональной архитектуры (портов и адаптеров) с четким разделением ответственностей:

```
[REST API (Pydantic schema)]
      |
      v
[Inbound Adapter]
      |
      v
[Mapper: Pydantic -> Internal DTO]
      |
      v
[Application Layer / Use Case]
      |
      v
[Mapper: Internal DTO -> Domain Entities]
      |
      v
[Domain Entities + Domain Services]
      |
      v
[Mapper: Domain Entities -> Internal DTO]
      |
      v
[Outbound Adapter]
      |
      v
[External DTO (Pydantic / Kafka schema)]
```

## Слои

### 1. Доменный слой (Domain Layer)

Содержит основную бизнес-логику, сущности, объекты-значения, события и порты.

**Компоненты:**
- **Entities** - основные бизнес-сущности
- **Value Objects** - объекты-значения
- **Services** - доменные сервисы
- **Events** - события домена
- **Ports** - интерфейсы для взаимодействия со внешними системами
- **Exceptions** - исключения домена

### 2. Слой приложения (Application Layer)

Содержит сценарии использования, которые координируют доменную логику.

**Компоненты:**
- **Use Cases** - сценарии использования
- **DTOs** - объекты передачи данных

### 3. Инфраструктурный слой (Infrastructure Layer)

Содержит адаптеры для внешних систем (REST API, база данных, шина сообщений).

**Компоненты:**
- **Adapters** - адаптеры для внешних систем
- **Mappers** - мапперы для преобразования данных
- **DI** - внедрение зависимостей
- **Config** - конфигурация

## Порты и адаптеры

### Входные порты (Inbound Ports)

Входные порты определяют интерфейсы, через которые внешние системы могут взаимодействовать с приложением.

### Выходные порты (Outbound Ports)

Выходные порты определяют интерфейсы, через которые приложение взаимодействует с внешними системами.

## Внедрение зависимостей

Для управления зависимостями используется фреймворк Dishka 1.6, который предоставляет:
- Скоупы (APP, REQUEST)
- Автоматическое внедрение зависимостей
- Управление жизненным циклом объектов

## Кэширование

Для повышения производительности используется Redis для кэширования:
- Кэширование отдельных категорий
- Кэширование списка всех категорий
- Автоматическая очистка кэша при изменениях